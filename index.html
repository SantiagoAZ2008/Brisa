<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brisa – Bienestar Emocional</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }

    body {
      background: linear-gradient(135deg, #4c1a24, #b33f55, #4c1a24);
      background-size: 300% 300%;
      animation: damasco 10s infinite alternate;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
    }

    @keyframes damasco {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Barra superior estilo navegador */
    .navBar {
      position: absolute;
      top: 0;
      width: 100%;
      height: 55px;
      background: rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      padding-left: 18px;
      backdrop-filter: blur(8px);
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      font-size: 18px;
      letter-spacing: 1px;
    }

    .card {
      width: 420px;
      background: rgba(255,255,255,0.07);
      padding: 35px;
      border-radius: 25px;
      backdrop-filter: blur(12px);
      box-shadow: 0 0 25px rgba(0,0,0,0.5);
      animation: fadeIn .9s ease-in-out;
      display: none;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    input, select {
      width: 100%;
      padding: 14px;
      margin-top: 12px;
      border-radius: 12px;
      border: none;
      background: rgba(255,255,255,0.18);
      color: white;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #d9485c;
      border: none;
      margin-top: 18px;
      border-radius: 12px;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover { background: #ff6074; }

    .menu-btn {
      margin-top: 12px;
      width: 100%;
      padding: 14px;
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.2);
    }

    .link { margin-top: 15px; cursor: pointer; text-decoration: underline; font-size: 14px; }

    #error, #errorReg { color:#ffb3b3; display:none; margin-top:12px; }

  </style>
</head>

<body>
  <div class="navBar">BRISA – PANEL</div>

  <!-- LOGIN -->
  <div class="card" id="loginCard" style="display:block;">
    <h1>Bienvenido</h1>
    <p>Inicia sesión para acceder</p>
    <input type="text" id="loginUser" placeholder="Usuario">
    <input type="password" id="loginPass" placeholder="Contraseña">
    <button onclick="login()">Entrar</button>
    <div id="error">Usuario o contraseña incorrectos</div>
    <div class="link" onclick="switchToRegister()">Crear cuenta</div>
  </div>

  <!-- REGISTER -->
  <div class="card" id="registerCard">
    <h1>Registro</h1>
    <input type="text" id="regUser" placeholder="Usuario nuevo">
    <input type="password" id="regPass" placeholder="Contraseña nueva">
    <button onclick="registerUser()">Registrar</button>
    <div id="errorReg">Complete los campos</div>
    <div class="link" onclick="switchToLogin()">Volver</div>
  </div>

  <!-- HOME -->
  <div class="card" id="homeCard">
    <h2>Hola <span id="userName"></span></h2>
    <button class="menu-btn" onclick="openEmotion()">Registrar emoción</button>
    <button class="menu-btn" onclick="openGame()">Mini-juegos</button>
    <button class="menu-btn" onclick="openHistory()">Historial emocional</button>
    <button class="menu-btn" onclick="openUsers()">Usuarios registrados</button>
    <button class="menu-btn" onclick="logout()">Cerrar sesión</button>
  </div>

  <!-- EMOTION -->
  <div class="card" id="emotionCard">
    <h2>Estado emocional</h2>
    <select id="emotionSelect">
      <option value="Feliz">Feliz</option>
      <option value="Triste">Triste</option>
      <option value="Ansioso">Ansioso</option>
      <option value="Cansado">Cansado</option>
      <option value="Motivado">Motivado</option>
      <option value="Molesto">Molesto</option>
      <option value="Confundido">Confundido</option>
    </select>
    <button onclick="saveEmotion()">Guardar</button>
    <div id="savedMsg"></div>
    <div class="link" onclick="returnHome()">Volver</div>
  </div>

  <!-- IMPROVED MINI-GAME -->
  <div class="card" id="gameCard">
    <h2>Reflejos</h2>
    <p>Presiona el botón cuando cambie de color</p>
    <button id="reactionBtn" style="background:#333;">Espera...</button>
    <p id="reactionResult"></p>
    <div class="link" onclick="returnHome()">Volver</div>
  </div>

  <!-- HISTORY -->
  <div class="card" id="historyCard">
    <h2>Historial emocional</h2>
    <div id="historyList"></div>
    <div class="link" onclick="returnHome()">Volver</div>
  </div>

  <!-- USERS -->
  <div class="card" id="usersCard">
    <h2>Usuarios registrados</h2>
    <div id="userList"></div>
    <div class="link" onclick="returnHome()">Volver</div>
  </div>

<script>
function switchToRegister(){ loginCard.style.display="none"; registerCard.style.display="block"; }
function switchToLogin(){ registerCard.style.display="none"; loginCard.style.display="block"; }

function registerUser(){
  let u = regUser.value.trim(); let p = regPass.value.trim();
  if(u.length<3 || p.length<3){ errorReg.style.display="block"; return; }

  let users = JSON.parse(localStorage.getItem("brisaUsers")) || [];
  users.push({ user:u, pass:p });
  localStorage.setItem("brisaUsers", JSON.stringify(users));
  switchToLogin();
}

function login(){
  let u = loginUser.value.trim(); let p = loginPass.value.trim();
  let users = JSON.parse(localStorage.getItem("brisaUsers")) || [];

  let exists = users.find(x => x.user===u && x.pass===p);
  if(exists){ loginCard.style.display="none"; homeCard.style.display="block"; userName.innerText=u; }
  else error.style.display="block";
}

function openEmotion(){ homeCard.style.display="none"; emotionCard.style.display="block"; }
function openGame(){ homeCard.style.display="none"; gameCard.style.display="block"; startReaction(); }
function openHistory(){ homeCard.style.display="none"; historyCard.style.display="block"; loadHistory(); }
function openUsers(){
